flowchart TD
    %% --- Overall Theme Setup ---
    %% Championship-level architecture with all hackathon requirements

    subgraph Frontend ["üéØ REACT DASHBOARD (Primary Judge Interface)"]
        direction TB
        
        InputSection["üìù INPUT SECTION
        ‚Ä¢ GitHub Repository URL
        ‚Ä¢ Team Name / Leader Name
        ‚Ä¢ Run Agent Button"]
        
        RunSummary["üìä RUN SUMMARY CARD
        ‚Ä¢ Status: PASSED/FAILED
        ‚Ä¢ Branch: TEAM_NAME_LEADER_AI_Fix
        ‚Ä¢ Time Taken: MM:SS"]
        
        ScoreBoard["üèÜ SCORE BREAKDOWN
        ‚Ä¢ Base: 100 | Speed: +10 | Efficiency: -2
        ‚Ä¢ FINAL TOTAL: [CALCULATED]"]
        
        FixesTable["üìã FIXES APPLIED TABLE
        ‚Ä¢ File | Bug Type | Line | Status"]
        
        Timeline["‚è±Ô∏è CI/CD TIMELINE
        ‚Ä¢ ‚úÖ/‚ùå per iteration (3/5)"]
        
        InputSection -->|API Call| API
        API -.->|Live Updates| RunSummary
        API -.->|Live Updates| ScoreBoard
        API -.->|Populate| FixesTable
        API -.->|Render| Timeline
    end

    subgraph API_Layer ["‚ö° FASTAPI ORCHESTRATOR"]
        direction TB
        API[üîå REST Endpoint: /run-agent]
        BranchGen["üîß Branch: TEAM_NAME_LEADER_AI_Fix"]
        Timer["‚è±Ô∏è Performance Timer"]
        JSON_Gen["üì¶ results.json Generator"]
        SSE["üì° Server-Sent Events"]
        
        API --> BranchGen
        API --> Timer
        API --> SSE
        JSON_Gen --> API
    end

    subgraph Agent_Core ["ü§ñ THE HEALING AGENT"]
        direction TB
        
        Start([üöÄ START]) --> Clone[üìÇ Repo Cloner]
        Clone --> Discover[üîç Test Discovery]
        Discover --> TestRun1[üß™ Initial Tests]
        
        TestRun1 -->|No Failures| FastPass[‚è© No Issues]
        TestRun1 -->|Failures| BugClassifier
        
        subgraph AI_Cabinet ["üß† GEMINI 1.5 PRO AGENTIC CABINET"]
            direction TB
            
            BugClassifier["üî¨ Minister of Classification
            Output: Bug Type (LINTING/SYNTAX/LOGIC/
                   TYPE_ERROR/IMPORT/INDENTATION)"]
            
            BugLocalizer["üìç Minister of Localization
            Output: File Path + Line Number"]
            
            FixGenerator["üîß Minister of Repair
            Output: Fixed Code + [AI-AGENT] Commit"]
            
            Validator["‚öñÔ∏è Minister of Validation
            ‚Ä¢ Anti-Hallucination Check
            ‚Ä¢ Format Compliance
            ‚Ä¢ Test Case Matching"]
            
            %% Circuit Breaker
            ValidationCounter["üîÑ Format Attempts: 0/3"]
            FallbackFix["üõü FALLBACK: Template Fix"]
            
            BugClassifier --> BugLocalizer
            BugLocalizer --> FixGenerator
            FixGenerator --> Validator
            Validator -->|‚ùå Invalid| ValidationCounter
            ValidationCounter -->|< 3| FixGenerator
            ValidationCounter -->|= 3| FallbackFix
            FallbackFix --> Validator
        end
        
        BugClassifier --> AI_Cabinet
        Validator -->|‚úÖ Valid| SandboxPrep
        
        subgraph Sandbox ["üîí DOCKER SANDBOX"]
            direction TB
            ApplyFix["üìù Apply Fix"] 
            RunTests["üß™ Run Tests"] 
            RecordIteration["üìä Record #"]
            CheckPass["‚úÖ Tests Pass?"]
            
            ApplyFix --> RunTests
            RunTests --> RecordIteration
            RecordIteration --> CheckPass
        end
        
        SandboxPrep["üì¶ Prepare Sandbox"] --> Sandbox
        
        CheckPass -->|‚ùå Failed| Retry{<5?}
        Retry -->|Yes| BugClassifier
        Retry -->|No| MarkFailed[‚ùå FAILED]
        CheckPass -->|‚úÖ Passed| PostProcessor
    end

    subgraph Post_Processing ["‚ú® POST-PROCESSOR"]
        direction TB
        Format["üîß Code Formatter"]
        FixesDB["üíæ Store Fix Record"]
        CommitCount["üìà Track Commit Counter"]
        
        Format --> FixesDB
        FixesDB --> CommitCount
    end

    subgraph Git_Ops ["üêô GIT OPS"]
        direction TB
        GitCommit["üì§ Commit: [AI-AGENT] prefix"]
        GitPush["üìå Push: TEAM_NAME_LEADER_AI_Fix"]
        
        GitCommit --> GitPush
    end

    subgraph Scoring ["üìä SCORING"]
        direction TB
        CalcBase["Base: 100"]
        CalcSpeed["Speed Bonus: +10"]
        CalcEfficiency["Penalty: -2 per commit >20"]
        FinalScore["üèÜ FINAL SCORE"]
        
        CalcBase --> CalcSpeed
        CalcSpeed --> CalcEfficiency
        CalcEfficiency --> FinalScore
    end

    %% CONNECTIONS
    PostProcessor --> GitCommit
    GitPush --> MarkPass[‚úÖ PASSED]
    
    MarkPass --> JSON_Gen
    MarkFailed --> JSON_Gen
    
    JSON_Gen --> FinalScore
    FinalScore --> API
    
    Timer --> CalcSpeed
    CommitCount --> CalcEfficiency
    API -.->|Update| Frontend

    %% --- STYLING - CLEAN AND NON-OVERLAPPING ---
    classDef dashboard fill:#0A2472,stroke:#00FFFF,color:#FFFFFF,rx:5
    classDef api fill:#2D1B4E,stroke:#FFD700,color:#FFFFFF,rx:5
    classDef ai fill:#FF1493,stroke:#FFFFFF,color:#FFFFFF,rx:8
    classDef breaker fill:#FFD700,stroke:#FF0000,color:#000000,rx:8
    classDef sandbox fill:#00A36C,stroke:#39FF14,color:#FFFFFF,rx:0
    classDef git fill:#FF8C00,stroke:#FFFFFF,color:#FFFFFF,rx:5
    classDef scoring fill:#4A2C00,stroke:#FFD700,color:#FFD700,rx:5
    classDef results fill:#006400,stroke:#00FF00,color:#FFFFFF,rx:5

    class InputSection,RunSummary,ScoreBoard,FixesTable,Timeline dashboard
    class API,BranchGen,Timer,JSON_Gen,SSE api
    class BugClassifier,BugLocalizer,FixGenerator,Validator ai
    class ValidationCounter,FallbackFix breaker
    class ApplyFix,RunTests,RecordIteration,CheckPass sandbox
    class GitCommit,GitPush git
    class CalcBase,CalcSpeed,CalcEfficiency,FinalScore scoring
    class MarkPass,MarkFailed,Start,JSON_Gen results